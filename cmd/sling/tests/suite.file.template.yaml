- n: "1"
  test_name: csv_pg_full_refresh
  source_conn: local
  source_stream: file://tests/files/test1.csv
  source_options: "{}"
  stream_config: "{}"
  target_conn: postgres
  target_object: "[schema].[table]"
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: '{"adjust_column_type":true, "add_new_columns":true, "use_bulk": true, "table_keys": { "unique": [ "id" ] }}'
  env: '{"validation_file": "file://tests/files/test1.csv", "validation_cols": "0,1,2,3,4,6"}'

- n: "2"
  test_name: pg_file_csv
  source_conn: postgres
  source_stream: "[schema].[table]"
  source_options: "{}"
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/files/[table].csv"
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: ""

- n: "3"
  test_name: pg_file_json
  source_conn: postgres
  source_stream: "[schema].[table]"
  source_options: "{}"
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/files/[table].json"
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: ""

- n: "4"
  test_name: pg_file_parquet
  source_conn: postgres
  source_stream: "[schema].[table]"
  source_options: "{}"
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/files/[table].parquet"
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: ""

- n: "5"
  test_name: pg_file_csv_many
  source_conn: postgres
  source_stream: "[schema].[table]"
  source_options: "{}"
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/csv/*.csv"
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: '{"file_max_rows": 100}'
  env: ""

- n: "6"
  test_name: discover_root
  source_conn: ""
  source_stream: ""
  source_options: ""
  stream_config: ""
  target_conn: "[conn]"
  target_object: ""
  mode: discover
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: '{"validation_contains": "[folder]/", "validation_not_contains": "[folder]/files/[table]", "validation_row_count": ">0"}'

- n: "7"
  test_name: discover_folder
  source_conn: ""
  source_stream: ""
  source_options: ""
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/files"
  mode: discover
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: '{"validation_contains": "[folder]/files/", "validation_row_count": "1"}'

- n: "8"
  test_name: discover_folder_files
  source_conn: ""
  source_stream: ""
  source_options: ""
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/files/"
  mode: discover
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: '{"validation_contains": "[folder]/files/[table].csv,[folder]/files/[table].json,[folder]/files/[table].parquet", "validation_not_contains": "[folder]/files/[table].parquet/", "validation_row_count": "3"}'

- n: "9"
  test_name: discover_folder_files_csv_wildcard
  source_conn: ""
  source_stream: ""
  source_options: ""
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/files/*.csv"
  mode: discover
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: '{"validation_contains": "[folder]/files/[table].csv", "validation_row_count": "1"}'

- n: "10"
  test_name: discover_filter
  source_conn: ""
  source_stream: ""
  source_options: ""
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/**/*[table].js*"
  mode: discover
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: '{"recursive": true, "validation_contains": "[folder]/files/[table].json", "validation_row_count": "1"}'

- n: "11"
  test_name: discover_file
  source_conn: ""
  source_stream: ""
  source_options: ""
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/files/[table].parquet"
  mode: discover
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: '{"validation_contains": "create_dt", "validation_row_count": "12", "level": "column"}'

- n: "12"
  test_name: discover_csv_folder_files
  source_conn: ""
  source_stream: ""
  source_options: ""
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]/csv/*.csv"
  mode: discover
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: '{"validation_row_count": ">5"}'

- n: "13"
  test_name: discover_recursive
  source_conn: ""
  source_stream: ""
  source_options: ""
  stream_config: ""
  target_conn: "[conn]"
  target_object: "[folder]"
  mode: discover
  source_primary_key: ""
  source_update_key: ""
  target_options: ""
  env: '{"recursive": true, "validation_row_count": ">5"}'

- n: "14"
  test_name: csv_to_pg
  source_conn: "[conn]"
  source_stream: "[folder]/files/[table].csv"
  source_options: ""
  stream_config: ""
  target_conn: postgres
  target_object: "[schema].[table]"
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: '{"adjust_column_type":true, "add_new_columns":true, "use_bulk": true, "table_keys": { "index": [ "id" ] }}'
  env: '{"validation_file": "file://tests/files/test1.csv", "validation_cols": "0,1,2,3,4,6"}'

- n: "15"
  test_name: parquet_to_pg
  source_conn: "[conn]"
  source_stream: "[folder]/files/[table].parquet"
  source_options: ""
  stream_config: ""
  target_conn: postgres
  target_object: "[schema].[table]"
  mode: incremental
  source_primary_key: ""
  source_update_key: _sling_loaded_at
  target_options: ""
  env: '{"validation_row_count": "2000"}'

- n: "16"
  test_name: folder_to_pg
  source_conn: "[conn]"
  source_stream: "[folder]/csv"
  source_options: ""
  stream_config: ""
  target_conn: postgres
  target_object: "[schema].[table]"
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: '{"adjust_column_type":true, "add_new_columns":true, "use_bulk": true, "table_keys": { "unique": [ "id" ] }}'
  env: '{"validation_file": "file://tests/files/test1.csv", "validation_cols": "0,1,2,3,4,6"}'

- n: "17"
  test_name: folder_files_to_pg
  source_conn: "[conn]"
  source_stream: "[folder]/csv/"
  source_options: ""
  stream_config: ""
  target_conn: postgres
  target_object: "[schema].[table]"
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: '{"adjust_column_type":true, "add_new_columns":true, "use_bulk": true, "table_keys": { "unique": [ "id" ] }}'
  env: '{"validation_file": "file://tests/files/test1.csv", "validation_cols": "0,1,2,3,4,6"}'

- n: "18"
  test_name: files_single_to_pg
  source_conn: "[conn]"
  source_stream: "[folder]/csv/*.csv"
  source_options: ""
  stream_config: '{"single": true}'
  target_conn: postgres
  target_object: "[schema].[table]"
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: '{"adjust_column_type":true, "add_new_columns":true, "use_bulk": true, "table_keys": { "unique": [ "id" ] }}'
  env: '{"validation_file": "file://tests/files/test1.csv", "validation_cols": "0,1,2,3,4,6"}'

- n: "19"
  test_name: files_single_to_local
  source_conn: "[conn]"
  source_stream: "[folder]/csv/*.csv"
  source_options: ""
  stream_config: '{"single": true}'
  target_conn: local
  target_object: /tmp/sling_test/[folder]/files/[table].csv
  mode: full-refresh
  source_primary_key: ""
  source_update_key: ""
  target_options: '{"file_max_rows": 0, "file_max_bytes": 0}'
  env: ""
